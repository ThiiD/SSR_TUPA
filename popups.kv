#:kivy 1.11.1

# <ConnectSocketPopup>:
#     title: 'Conexão Socket'
#     # size_hint_y: 0.3
#     # size_hint_x: 0.2
#     size_hint: None, None
#     size: (600, 375)
#     BoxLayout:
#         id: layout
#         orientation:'vertical'
#         GridLayout:
#             size_hint: (1, .8)
#             cols: 2
#             rows: 6
#             Label:
#                 text: "IP"
#                 font_size: 14
#             TextInput:
#                 id: txt_ip
#                 text: '127.0.0.1'
#                 font_size: 14
#                 halign: 'center'
#                 valign: 'middle'
#                 disabled: False
#             Label:
#                 text: "Port"
#                 font_size: 14
#             TextInput:
#                 id: txt_port
#                 text: '502'
#                 font_size: 14
#                 halign: 'center'
#                 valign: 'middle'
#                 disabled: False
#             Label:
#                 text: "Login"
#                 font_size: 14
#             TextInput:
#                 id: txt_login
#                 hint_text: 'login'
#                 font_size: 14
#                 halign: 'center'
#                 valign: 'middle'
#                 disabled: False
#             Label:
#                 text: "Senha"
#                 font_size: 14
#             TextInput:
#                 id: txt_senha
#                 hint_text: 'senha'
#                 font_size: 14
#                 halign: 'center'
#                 valign: 'middle'
#                 disabled: False
#             Label:
#                 text: 'Missão'
#                 font_size: 14
#             TextInput:
#                 id: txt_missao
#                 text: ''
#                 font_size: 14
#                 halign: 'center'
#                 valign: 'middle'
#                 disabled: False
#             Label:
#                 text: 'Apogeu'
#                 font_size: 14
#             Spinner:
#                 id: txt_apogeu
#                 text: "Selecione o apogeu"
#                 values: ['500', '1000', '3000', '5000']
#                 disabled: False

#         BoxLayout:
#             orientation:'horizontal'
#             size_hint: (1, .2)
#             Button:
#                 id: connButton
#                 size_hint_y: None
#                 height: 40
#                 text: 'Conectar'
#                 on_release:
#                     app.root._login = txt_login.text
#                     app.root._senha = txt_senha.text
#                     app.root._serverIP = txt_ip.text
#                     app.root._missao = txt_missao.text
#                     app.root._port = txt_port.text
#                     app.root._apogeu = txt_apogeu.text
#                     app.root.clickConnection()
#             Button:
#                 size_hint_y: None
#                 height: 40
#                 text:'Fechar'
#                 on_release: root.dismiss()


# <ConnectSocketPopup>:
#     title: 'Opções de conexão'
#     # size_hint_y: 0.3
#     # size_hint_x: 0.2
#     size_hint: None, None
#     size: (600, 375)
#     BoxLayout:
#         id: layout
#         orientation:'vertical'
#         GridLayout:
#             size_hint: (1, .8)
#             cols: 2
#             rows: 6
#             size_hint_y: 0.05
#             Label:
#                 text: "Conexão"
#                 font_size: 14
                
#             Spinner:
#                 id: opt_conexao
#                 text: "Comunicação"
#                 values: ['UART', 'WiFi']
#                 size_hint: (1, 0.25)
#                 disabled: False
#                 on_text: root.manager.current = self.text

#             # WindowManager:
#             #     id: window_manager
#             #     FirstWindow:
#             #         id: window_uart
#             #         Label:
#             #             text: "Teste"
#             #             font_size:14

            

#         BoxLayout:
#             orientation:'horizontal'
#             size_hint: (1, .2)
#             Button:
#                 id: connButton
#                 size_hint_y: None
#                 height: 40
#                 text: 'Conectar'
#                 on_release:
#                     app.root._login = txt_login.text
#                     app.root._senha = txt_senha.text
#                     app.root._serverIP = txt_ip.text
#                     app.root._missao = txt_missao.text
#                     app.root._port = txt_port.text
#                     app.root._apogeu = txt_apogeu.text
#                     app.root.clickConnection()
#             Button:
#                 size_hint_y: None
#                 height: 40
#                 text:'Fechar'
#                 on_release: root.dismiss()

    
<ConnectSocketPopup>:
    title: 'Opções de conexão'
    # size_hint_y: 0.3
    # size_hint_x: 0.2
    size_hint: None, None
    size: (600, 375)
    BoxLayout:
        id: layout
        orientation:'vertical'
        GridLayout:
            size_hint: (1, .8)
            cols: 2
            rows: 6
            # size_hint_y: 0.05
            Label:
                text: "Conexão"
                font_size: 14
                
            Spinner:
                id: opt_conexao
                text: "UART"
                values: ['UART', 'WiFi']
                disabled: True
                on_text: root.manager.current = self.text         
            Label:
                text: "Porta"
                font_size: 14
            TextInput:
                id: txt_porta
                text: ''
                font_size: 14
                halign: 'center'
                valign: 'middle'
                disabled: False
            Label:
                text: "Baudrate"
                font_size: 14
            TextInput:
                id: txt_baudrate
                text: ''
                font_size: 14
                halign: 'center'
                valign: 'middle'
                disabled: False
            Label:
                text: 'Missão'
                font_size: 14
            TextInput:
                id: txt_missao
                text: ''
                font_size: 14
                halign: 'center'
                valign: 'middle'
                disabled: False
            Label:
                text: 'Apogeu'
                font_size: 14
            Spinner:
                id: txt_apogeu
                text: "Selecione o apogeu"
                values: ['500', '1000', '3000', '5000']
                disabled: False
            

        BoxLayout:
            orientation:'horizontal'
            size_hint: (1, .2)
            Button:
                id: connButton
                size_hint_y: None
                height: 40
                text: 'Conectar'
                on_release:
                    app.root._porta = txt_porta.text
                    app.root._baudrate = txt_baudrate.text
                    app.root._missao = txt_missao.text
                    app.root._apogeu = txt_apogeu.text
                    app.root.clickConnection()
            Button:
                size_hint_y: None
                height: 40
                text:'Fechar'
                on_release: root.dismiss()


<ConnectSocketPopupError>:
    title: ""
    separator_height: 0
    size_hint: None, None
    size: (250, 100)
    BoxLayout:
        orientation: 'vertical'
        Button:
            id: erroConnect
            background_color: 0, 0, 0, 0
            size_hint_y: None
            height: 40
            text: "Falha ao conectar!"
            font_size: 14
            halign: "center"
            valign: "middle"
        Button:
            size_hint_y: None
            height: 40
            text: "Fechar"
            halign: "center"
            valign: "middle"
            on_release: root.dismiss()

<SendMessagePopup>:
    title: "Envio de Mensagens"
    size_hint: None, None
    separator_height: 2
    size: (600,280)
    BoxLayout:
        orientation:"vertical"
        GridLayout:
            rows: 4
            cols: 3
            size_hint: (1, .8)
            CheckBox:
                id: checkbox_iac_controle
                _name: "Controle_IAC"
                on_active: app.root._connect._getCommand(self._name, self.active)
            Label:
                id:txt_controle
                font_size: 14
                text: "Habilita Controle"
            BoxLayout:
                orientation:"horizontal"
                CheckBox:
                    id: checkbox_controle_sim
                    group: "controle_options"
                    _name: "Controle_Estado"
                    command: 1
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_controle_sim
                    text: "Sim"
                    font_size: 14
                CheckBox:
                    id: checkbox_controle_nao
                    group: "controle_options"
                    _name: "Controle_Estado"
                    command: 0
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_controle_nao
                    text: "Não"
                    font_size: 14
            CheckBox:
                id: checkbox_iac_antena
                _name: "Antena_IAC"
                on_active: app.root._connect._getCommand(self._name, self.active)
            Label:
                id:txt_antena
                font_size: 14
                text: "Ativa antena"
            BoxLayout:
                orientation:"horizontal"
                CheckBox:
                    id: checkbox_antena_sim
                    group: "antena_options"
                    _name: "Antena_Estado"
                    command: 1
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_antena_sim
                    text: "Sim"
                    font_size: 14
                CheckBox:
                    id: checkbox_antena_nao
                    group: "antena_options"
                    _name: "Antena_Estado"
                    command: 0
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_antena_nao
                    text: "Não"
                    font_size: 14
            CheckBox:
                id: checkbox_iac_missao
                _name: "Missao_IAC"
                on_active: app.root._connect._getCommand(self._name, self.active)
            Label:
                id:txt_missao
                font_size: 14
                text: "Ativa missão"
            BoxLayout:
                orientation:"horizontal"
                CheckBox:
                    id: checkbox_missao_m1
                    group: "missao_options"
                    _name: "Missao_Estado"
                    command: 0
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_missao_m1
                    text: "M1"
                    font_size: 14
                CheckBox:
                    id: checkbox_missao_m2
                    group: "missao_options"
                    _name: "Missao_Estado"
                    command: 1
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_missao_m2
                    text: "M2"
                    font_size: 14
                CheckBox:
                    id: checkbox_missao_stop
                    group: "missao_options"
                    _name: "Missao_Estado"
                    command: 2
                    on_active: app.root._connect._getCommand(self._name, self.command)
                Label:
                    id: txt_checkbox_missao_stop
                    text: "Parar"
                    font_size: 14
            CheckBox:
                id: checkbox_iac_setpoint
                _name: "Setpoint_IAC"
                on_active: app.root._connect._getCommand(self._name, self.active)
            Label:
                id:txt_setpoint
                font_size: 14
                text: "Valor setpoint:"
            TextInput:
                id: setpoint_value
                font_size: 14
                halign: 'center'
                valign: 'middle'
                size_hint_y: 0.5
                text: "0"
            # TextInput:
            #     id: setpoint_value
            #     size_hint: (0.8, 0.4)
            #     font_size: 14
            #     halign: 'center'
            #     valign: 'middle'
            #     text: ''

        BoxLayout:
            orientation:'horizontal'
            size_hint: (1, .2)
            Button:
                id: send_button
                size_hint_y: None
                height: 40
                text: 'Enviar'
                on_release: 
                    app.root._connect._getCommand("Setpoint_Value", setpoint_value.text)
                    app.root._connect._sendData()
                    root.dismiss()
                    # app.root._connect._sendData(checkbox_iac_controle.active, checkbox_controle_sim.active, checkbox_controle_nao.active, \
                    # checkbox_iac_antena.active,  checkbox_antena_sim.active, checkbox_antena_nao.active, \
                    # checkbox_iac_missao.active, checkbox_missao_m1.active, checkbox_missao_m2.active, \
                    # checkbox_iac_setpoint.active, setpoint_value.text )
            Button:
                size_hint_y: None
                height: 40
                text:'Fechar'
                on_release: root.dismiss()



<ConfiguraGraficosPopup>:
    title: 'Configuração dos Gráficos'
    size_hint_y: 0.3
    size_hint_x: 0.2
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.7
            size_hint_x: 1
            LabeledChedBoxDataGraph:
                id: mp20
                on_kv_post:
                    self.ids.label.text = '20'
                    self.ids.checkbox.group = 'cb_group'
            LabeledChedBoxDataGraph:
                id: mp50
                on_kv_post:
                    self.ids.label.text = '50'
                    self.ids.checkbox.group = 'cb_group'
            LabeledChedBoxDataGraph:
                id: mp20
                on_kv_post:
                    self.ids.label.text = '100'
                    self.ids.checkbox.group = 'cb_group'
        Button:
            text: 'Fechar'
            size_hint: (0.2, 1)
            on_relase: root.dismiss()


<LabeledChedBoxDataGraph>:
    orientation: 'horizontal'
    size_hint: (0.1, 1)
    CheckBox:
        id: checkbox
        on_active: app.root._graphAltitude.ids.graphAltitude.setMaxPoints(int(label.text), 0) if app.root is not None else None
    Label:
        id: label

<UARTConnect>:
    title: 'Opções de conexão'
    size_hint: None, None
    size: (600, 375)
    BoxLayout:
        id: layout
        orientation:'vertical'
        GridLayout:
            size_hint: (1, .8)
            cols: 2
            rows: 6
            size_hint_y: 0.05
            Label:
                text: "Conexão"
                font_size: 14
                
            Spinner:
                id: opt_conexao
                text: "UART"
                values: ['UART', 'WiFi']
                size_hint: (1, 0.25)
                disabled: False

            Label:
                text: "Porta"
                font_size: 14
